{"level":"error","message":"Email configuration error: Cannot read properties of undefined (reading 'transporter')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'transporter')\n    at testEmailConfig (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\sendEmail.js:1436:18)\n    at testEmailOnStartup (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:268:13)\n    at startServer (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:403:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-12-03T14:52:48.047Z"}
{"level":"error","message":"Email configuration error: Cannot read properties of undefined (reading 'transporter')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'transporter')\n    at testEmailConfig (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\sendEmail.js:1436:18)\n    at testEmailOnStartup (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:270:13)\n    at startServer (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:405:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-12-03T15:07:21.586Z"}
{"level":"error","message":"Email configuration error: Cannot read properties of undefined (reading 'transporter')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'transporter')\n    at testEmailConfig (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\sendEmail.js:1436:18)\n    at testEmailOnStartup (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:270:13)\n    at startServer (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:405:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-12-03T15:08:42.642Z"}
{"level":"error","message":"Email configuration error: Cannot read properties of undefined (reading 'transporter')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'transporter')\n    at testEmailConfig (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\sendEmail.js:1436:18)\n    at testEmailOnStartup (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:270:13)\n    at startServer (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:405:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-12-03T15:08:49.723Z"}
{"level":"error","message":"Email configuration error: Cannot read properties of undefined (reading 'transporter')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'transporter')\n    at testEmailConfig (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\sendEmail.js:1436:18)\n    at testEmailOnStartup (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:270:13)\n    at startServer (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:405:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-12-03T15:08:57.916Z"}
{"level":"error","message":"Email configuration error: Cannot read properties of undefined (reading 'transporter')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'transporter')\n    at testEmailConfig (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\sendEmail.js:1436:18)\n    at testEmailOnStartup (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:270:13)\n    at startServer (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:405:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-12-03T15:09:34.419Z"}
{"level":"error","message":"Email configuration error: Cannot read properties of undefined (reading 'transporter')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'transporter')\n    at testEmailConfig (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\sendEmail.js:1436:18)\n    at testEmailOnStartup (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:270:13)\n    at startServer (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:405:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-12-03T15:13:49.784Z"}
{"level":"error","message":"Email configuration error: Cannot read properties of undefined (reading 'transporter')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'transporter')\n    at testEmailConfig (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\sendEmail.js:1436:18)\n    at testEmailOnStartup (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:270:13)\n    at startServer (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\server.js:405:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-12-03T15:28:38.068Z"}
{"level":"error","message":"Error fetching notifications: Notification.find is not a function","service":"booking-system","stack":"TypeError: Notification.find is not a function\n    at getNotifications (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\controllers\\bookingController.js:371:48)\n    at Layer.handleRequest (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\router\\lib\\route.js:157:13)\n    at middleware (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\express-validator\\lib\\middlewares\\check.js:16:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-12-03T15:44:27.705Z"}
{"_message":"Booking validation failed","errors":{"instrument":{"kind":"enum","message":"`guitar` is not a valid enum value for path `instrument`.","name":"ValidatorError","path":"instrument","properties":{"enumValues":["Guitar","Piano","Violin","Drums","Bass"],"length":6,"message":"`guitar` is not a valid enum value for path `instrument`.","path":"instrument","type":"enum","value":"guitar"},"value":"guitar"}},"level":"error","message":"Error creating booking: Booking validation failed: instrument: `guitar` is not a valid enum value for path `instrument`.","service":"booking-system","stack":"ValidationError: Booking validation failed: instrument: `guitar` is not a valid enum value for path `instrument`.\n    at Document.invalidate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3365:32)\n    at validatePath (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3140:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Promise.all (index 3)\n    at async model.$__validate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3081:3)\n    at async model.validate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:2663:5)\n    at async model.validateBeforeSave (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\plugins\\validateBeforeSave.js:34:7)\n    at async Kareem.execPre (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\kareem\\index.js:65:24)\n    at async model.$__save (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\model.js:369:5)\n    at async model.save (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\model.js:609:5)","timestamp":"2025-12-03T19:33:20.587Z"}
{"level":"info","message":"New booking created: 693090ab3de3fa1e1116ba2e for johndoe@example.com","service":"booking-system","timestamp":"2025-12-03T19:34:03.856Z"}
{"_message":"Notification validation failed","errors":{"type":{"kind":"enum","message":"`admin_alert` is not a valid enum value for path `type`.","name":"ValidatorError","path":"type","properties":{"enumValues":["booking_created","booking_updated","status_update","system"],"length":11,"message":"`admin_alert` is not a valid enum value for path `type`.","path":"type","type":"enum","value":"admin_alert"},"value":"admin_alert"}},"level":"error","message":"Error creating notification: Notification validation failed: type: `admin_alert` is not a valid enum value for path `type`.","service":"booking-system","stack":"ValidationError: Notification validation failed: type: `admin_alert` is not a valid enum value for path `type`.\n    at Document.invalidate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3365:32)\n    at validatePath (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3140:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Promise.all (index 1)\n    at async model.$__validate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3081:3)\n    at async model.validate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:2663:5)\n    at async model.validateBeforeSave (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\plugins\\validateBeforeSave.js:34:7)\n    at async Kareem.execPre (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\kareem\\index.js:65:24)\n    at async model.$__save (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\model.js:369:5)\n    at async model.save (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\model.js:609:5)","timestamp":"2025-12-03T19:34:03.867Z"}
{"_message":"Notification validation failed","errors":{"type":{"kind":"enum","message":"`admin_alert` is not a valid enum value for path `type`.","name":"ValidatorError","path":"type","properties":{"enumValues":["booking_created","booking_updated","status_update","system"],"length":11,"message":"`admin_alert` is not a valid enum value for path `type`.","path":"type","type":"enum","value":"admin_alert"},"value":"admin_alert"}},"level":"error","message":"Error sending admin alert: Notification validation failed: type: `admin_alert` is not a valid enum value for path `type`.","service":"booking-system","stack":"ValidationError: Notification validation failed: type: `admin_alert` is not a valid enum value for path `type`.\n    at Document.invalidate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3365:32)\n    at validatePath (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3140:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Promise.all (index 1)\n    at async model.$__validate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3081:3)\n    at async model.validate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:2663:5)\n    at async model.validateBeforeSave (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\plugins\\validateBeforeSave.js:34:7)\n    at async Kareem.execPre (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\kareem\\index.js:65:24)\n    at async model.$__save (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\model.js:369:5)\n    at async model.save (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\model.js:609:5)","timestamp":"2025-12-03T19:34:03.870Z"}
{"_message":"Notification validation failed","errors":{"type":{"kind":"enum","message":"`admin_alert` is not a valid enum value for path `type`.","name":"ValidatorError","path":"type","properties":{"enumValues":["booking_created","booking_updated","status_update","system"],"length":11,"message":"`admin_alert` is not a valid enum value for path `type`.","path":"type","type":"enum","value":"admin_alert"},"value":"admin_alert"}},"level":"error","message":"Error creating booking: Notification validation failed: type: `admin_alert` is not a valid enum value for path `type`.","service":"booking-system","stack":"ValidationError: Notification validation failed: type: `admin_alert` is not a valid enum value for path `type`.\n    at Document.invalidate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3365:32)\n    at validatePath (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3140:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Promise.all (index 1)\n    at async model.$__validate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:3081:3)\n    at async model.validate (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\document.js:2663:5)\n    at async model.validateBeforeSave (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\plugins\\validateBeforeSave.js:34:7)\n    at async Kareem.execPre (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\kareem\\index.js:65:24)\n    at async model.$__save (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\model.js:369:5)\n    at async model.save (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\node_modules\\mongoose\\lib\\model.js:609:5)","timestamp":"2025-12-03T19:34:03.876Z"}
{"level":"info","message":"New booking created: 6930913f7bfb4a22b87992b6 for johndoe@example.com","service":"booking-system","timestamp":"2025-12-03T19:36:31.395Z"}
{"level":"error","message":"Error sending email notification: Cannot read properties of undefined (reading 'sendMail')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'sendMail')\n    at NotificationService.sendEmailNotification (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\notificationService.js:93:38)\n    at NotificationService.createNotification (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\notificationService.js:20:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async NotificationService.sendBookingAlertToAdmin (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\notificationService.js:117:28)\n    at async createBooking (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\controllers\\bookingController.js:34:7)","timestamp":"2025-12-03T19:36:31.558Z"}
{"level":"info","message":"Notification created: 6930913f7bfb4a22b87992b8 for uwasehamissa123@gmail.com","service":"booking-system","timestamp":"2025-12-03T19:36:31.560Z"}
{"level":"error","message":"Error sending email notification: Cannot read properties of undefined (reading 'sendMail')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'sendMail')\n    at NotificationService.sendEmailNotification (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\notificationService.js:93:38)\n    at NotificationService.createNotification (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\notificationService.js:20:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async createBooking (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\controllers\\bookingController.js:40:7)","timestamp":"2025-12-03T19:36:40.395Z"}
{"level":"info","message":"Notification created: 693091487bfb4a22b87992ba for johndoe@example.com","service":"booking-system","timestamp":"2025-12-03T19:36:40.397Z"}
{"level":"info","message":"New booking created: 693091657bfb4a22b87992bc for kingsleon250@gmail.com","service":"booking-system","timestamp":"2025-12-03T19:37:09.663Z"}
{"level":"error","message":"Error sending email notification: Cannot read properties of undefined (reading 'sendMail')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'sendMail')\n    at NotificationService.sendEmailNotification (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\notificationService.js:93:38)\n    at NotificationService.createNotification (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\notificationService.js:20:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async NotificationService.sendBookingAlertToAdmin (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\notificationService.js:117:28)\n    at async createBooking (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\controllers\\bookingController.js:34:7)","timestamp":"2025-12-03T19:37:09.807Z"}
{"level":"info","message":"Notification created: 693091657bfb4a22b87992be for uwasehamissa123@gmail.com","service":"booking-system","timestamp":"2025-12-03T19:37:09.810Z"}
{"level":"error","message":"Error sending email notification: Cannot read properties of undefined (reading 'sendMail')","service":"booking-system","stack":"TypeError: Cannot read properties of undefined (reading 'sendMail')\n    at NotificationService.sendEmailNotification (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\notificationService.js:93:38)\n    at NotificationService.createNotification (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\emails\\notificationService.js:20:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async createBooking (C:\\Users\\ioutyr\\Desktop\\ndizmusicprojectbackend\\controllers\\bookingController.js:40:7)","timestamp":"2025-12-03T19:37:15.435Z"}
{"level":"info","message":"Notification created: 6930916b7bfb4a22b87992c0 for kingsleon250@gmail.com","service":"booking-system","timestamp":"2025-12-03T19:37:15.436Z"}
